# Progressive Web App (PWA) Setup

The Solo Compendium app is configured as a Progressive Web App (PWA) with offline support and installability.

## Features

### ‚úÖ Implemented

- **Service Worker**: Caches app assets and API responses for offline use
- **Offline Support**: App works offline with cached data
- **Install Prompt**: Users can install the app on their devices
- **Update Notifications**: Users are notified when new versions are available
- **Offline Indicator**: Visual indicator when the user is offline
- **Smart Caching**: 
  - Static assets cached for offline use
  - API responses cached with NetworkFirst strategy
  - Images cached with CacheFirst strategy
  - Supabase storage cached for 7 days

### üì± Installation

Users can install the app on:
- **Desktop**: Chrome, Edge, Safari (macOS)
- **Mobile**: iOS Safari, Android Chrome
- **Tablets**: All modern browsers

**How to Install:**
1. Visit the app in a supported browser
2. Look for the install prompt or browser menu option
3. Click "Install" or "Add to Home Screen"
4. The app will open in standalone mode

## Service Worker

The service worker is automatically generated by `vite-plugin-pwa` during the build process.

### Caching Strategies

1. **Static Assets** (JS, CSS, HTML, icons)
   - Cached on first load
   - Served from cache when offline

2. **API Requests** (Supabase)
   - NetworkFirst: Try network first, fall back to cache
   - Cache expires after 24 hours
   - Max 50 cached entries

3. **Storage Files** (Images, uploads)
   - CacheFirst: Serve from cache if available
   - Cache expires after 7 days
   - Max 100 cached entries

4. **Images** (PNG, JPG, SVG, WebP)
   - CacheFirst: Serve from cache if available
   - Cache expires after 30 days
   - Max 100 cached entries

### Update Process

1. When a new version is deployed, the service worker detects changes
2. New service worker is installed in the background
3. User is prompted to update
4. On update, the page reloads to use the new service worker

## Offline Functionality

### What Works Offline

- ‚úÖ Viewing cached compendium entries
- ‚úÖ Viewing cached character data
- ‚úÖ Browsing previously loaded pages
- ‚úÖ Using cached images and assets

### What Requires Online

- ‚ùå Fetching new compendium entries
- ‚ùå Creating/updating characters
- ‚ùå Authentication
- ‚ùå Real-time features (campaign chat, etc.)

## Configuration

### Icons

The app requires PWA icons. Place these files in the `public` directory:

- `icon-192.png` - 192x192px icon
- `icon-512.png` - 512x512px icon

**Note**: These icons are referenced in the manifest but need to be created/added.

### Manifest

The manifest is configured in `vite.config.ts` and includes:
- App name and description
- Theme colors
- Display mode (standalone)
- Icons
- Shortcuts (Compendium, Characters)

### Development

Service worker is **disabled in development** to avoid caching issues during development.

To test PWA features:
1. Build for production: `npm run build`
2. Preview: `npm run preview`
3. Test install and offline functionality

## Troubleshooting

### Service Worker Not Registering

- Check browser console for errors
- Ensure you're using HTTPS (or localhost)
- Clear browser cache and reload

### Updates Not Showing

- Check if service worker is active in DevTools ‚Üí Application ‚Üí Service Workers
- Click "Update" to force update check
- Clear cache and reload

### Offline Mode Not Working

- Ensure service worker is registered
- Check that assets are being cached (DevTools ‚Üí Application ‚Üí Cache Storage)
- Verify network requests are being intercepted

## Browser Support

- ‚úÖ Chrome/Edge (Desktop & Mobile)
- ‚úÖ Firefox (Desktop & Mobile)
- ‚úÖ Safari (iOS 11.3+, macOS)
- ‚úÖ Samsung Internet
- ‚ö†Ô∏è Opera (Limited support)

## Future Enhancements

- Background sync for offline actions
- Push notifications
- Share target API
- File system access API
- Periodic background sync

